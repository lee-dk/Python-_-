<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<title>simpleMap</title>
		<script	src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
		<script src="https://apis.openapi.sk.com/tmap/jsv2?version=1&appKey=l7xxd0e2cb7978924dbfab496f5d7aabce1a"></script>
		<script type="text/javascript">

            var x_pos = ['127.014', '126.979', '126.993', '126.949', '127.077', '126.994', '127.003']
            var y_pos = ['37.596326', '37.568157', '37.572195', '37.587077', '37.458150', '37.569238', '37.573050']
			function iterFunc() {

				// 좌표 목록 입력
				// element = [origin_x, origin_y, destination_x, destination_y]
				var coordArr = [
				    //[출발x, 출발y, 도착x, 도착y]

                    [x_pos[0], y_pos[0], x_pos[1], y_pos[1]],
					[x_pos[1], y_pos[1], x_pos[2], y_pos[2]],
					[x_pos[2], y_pos[2], x_pos[3], y_pos[3]],
					[x_pos[3], y_pos[3], x_pos[4], y_pos[4]],
					[x_pos[4], y_pos[4], x_pos[5], y_pos[5]],
					[x_pos[5], y_pos[5], x_pos[6], y_pos[6]],
					[x_pos[1], y_pos[1], x_pos[2], y_pos[2]],
				];

				for(var cnt in coordArr){			// 전체 반복
					var ele = coordArr[cnt];

					var ox = ele[0];
					var oy = ele[1];
					var dx = ele[2];
					var dy = ele[3];

					var rowid = parseInt(cnt) + 1000;

					getTime(ox, oy, dx, dy);
				};
			}

			function getTime(ox, oy, dx, dy) {
                    $.ajax({
                        type : "POST",
                        url : "https://apis.openapi.sk.com/tmap/routes?version=1&format=json&callback=result",
                        async : false,
                        data : {
                            "appKey" : "l7xxd0e2cb7978924dbfab496f5d7aabce1a",
                            "startX" : ox,
                            "startY" : oy,
                            "endX" : dx,
                            "endY" : dy,
                            "reqCoordType" : "WGS84GEO",
                            "resCoordType" : "EPSG3857",
                            "searchOption" : "0",
                            "trafficInfo" : "N"
                        },
                        success : function(response) {

                            var resultData = response.features;

                            var tDistance = (resultData[0].properties.totalDistance / 1000).toFixed(2);
                            var tTime = (resultData[0].properties.totalTime / 60).toFixed(0);


                            // 출력 형식
                            var rtnMsg = ox + ", " + oy + ", " + dx + ", " + dy + ", "
                                            + tDistance + ", " + tTime + "<br>";


                            $("#result").append(rtnMsg);

                        },
                        error : function(request, status, error) {
                            console.log("code:"
                                    + request.status + "\n"
                                    + "message:"
                                    + request.responseText
                                    + "\n" + "error:" + error );
                        }
                    });
			}

		</script>
	</head>
	<body onload="iterFunc();">
		<!-- 데이터 헤더 -->
		<p id="result">Start_X, Start_Y, End_X, End_Y, TravelTime, T_dist_km<br></p>
	</body>
</html>
